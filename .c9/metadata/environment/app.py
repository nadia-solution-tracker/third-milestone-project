{"filter":false,"title":"app.py","tooltip":"/app.py","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":144,"column":75},"end":{"row":145,"column":0},"action":"remove","lines":["",""],"id":2898}],[{"start":{"row":144,"column":75},"end":{"row":144,"column":76},"action":"insert","lines":[" "],"id":2899}],[{"start":{"row":145,"column":48},"end":{"row":145,"column":52},"action":"remove","lines":["    "],"id":2900},{"start":{"row":145,"column":44},"end":{"row":145,"column":48},"action":"remove","lines":["    "]},{"start":{"row":145,"column":40},"end":{"row":145,"column":44},"action":"remove","lines":["    "]},{"start":{"row":145,"column":36},"end":{"row":145,"column":40},"action":"remove","lines":["    "]},{"start":{"row":145,"column":32},"end":{"row":145,"column":36},"action":"remove","lines":["    "]},{"start":{"row":145,"column":28},"end":{"row":145,"column":32},"action":"remove","lines":["    "]},{"start":{"row":145,"column":24},"end":{"row":145,"column":28},"action":"remove","lines":["    "]},{"start":{"row":145,"column":20},"end":{"row":145,"column":24},"action":"remove","lines":["    "]},{"start":{"row":145,"column":16},"end":{"row":145,"column":20},"action":"remove","lines":["    "]},{"start":{"row":145,"column":12},"end":{"row":145,"column":16},"action":"remove","lines":["    "]},{"start":{"row":145,"column":8},"end":{"row":145,"column":12},"action":"remove","lines":["    "]},{"start":{"row":145,"column":4},"end":{"row":145,"column":8},"action":"remove","lines":["    "]},{"start":{"row":145,"column":0},"end":{"row":145,"column":4},"action":"remove","lines":["    "]},{"start":{"row":144,"column":101},"end":{"row":145,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":144,"column":101},"end":{"row":144,"column":102},"action":"insert","lines":[" "],"id":2901}],[{"start":{"row":149,"column":48},"end":{"row":149,"column":52},"action":"remove","lines":["    "],"id":2902},{"start":{"row":149,"column":44},"end":{"row":149,"column":48},"action":"remove","lines":["    "]},{"start":{"row":149,"column":40},"end":{"row":149,"column":44},"action":"remove","lines":["    "]},{"start":{"row":149,"column":36},"end":{"row":149,"column":40},"action":"remove","lines":["    "]},{"start":{"row":149,"column":32},"end":{"row":149,"column":36},"action":"remove","lines":["    "]},{"start":{"row":149,"column":28},"end":{"row":149,"column":32},"action":"remove","lines":["    "]},{"start":{"row":149,"column":24},"end":{"row":149,"column":28},"action":"remove","lines":["    "]},{"start":{"row":149,"column":20},"end":{"row":149,"column":24},"action":"remove","lines":["    "]},{"start":{"row":149,"column":16},"end":{"row":149,"column":20},"action":"remove","lines":["    "]},{"start":{"row":149,"column":12},"end":{"row":149,"column":16},"action":"remove","lines":["    "]},{"start":{"row":149,"column":8},"end":{"row":149,"column":12},"action":"remove","lines":["    "]},{"start":{"row":149,"column":4},"end":{"row":149,"column":8},"action":"remove","lines":["    "]}],[{"start":{"row":149,"column":0},"end":{"row":149,"column":4},"action":"remove","lines":["    "],"id":2903},{"start":{"row":148,"column":75},"end":{"row":149,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":148,"column":75},"end":{"row":148,"column":76},"action":"insert","lines":[" "],"id":2904}],[{"start":{"row":153,"column":48},"end":{"row":153,"column":52},"action":"remove","lines":["    "],"id":2905},{"start":{"row":153,"column":44},"end":{"row":153,"column":48},"action":"remove","lines":["    "]},{"start":{"row":153,"column":40},"end":{"row":153,"column":44},"action":"remove","lines":["    "]},{"start":{"row":153,"column":36},"end":{"row":153,"column":40},"action":"remove","lines":["    "]},{"start":{"row":153,"column":32},"end":{"row":153,"column":36},"action":"remove","lines":["    "]},{"start":{"row":153,"column":28},"end":{"row":153,"column":32},"action":"remove","lines":["    "]},{"start":{"row":153,"column":24},"end":{"row":153,"column":28},"action":"remove","lines":["    "]},{"start":{"row":153,"column":20},"end":{"row":153,"column":24},"action":"remove","lines":["    "]},{"start":{"row":153,"column":16},"end":{"row":153,"column":20},"action":"remove","lines":["    "]},{"start":{"row":153,"column":12},"end":{"row":153,"column":16},"action":"remove","lines":["    "]},{"start":{"row":153,"column":8},"end":{"row":153,"column":12},"action":"remove","lines":["    "]},{"start":{"row":153,"column":4},"end":{"row":153,"column":8},"action":"remove","lines":["    "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":152,"column":75},"end":{"row":153,"column":0},"action":"remove","lines":["",""],"id":2906}],[{"start":{"row":152,"column":75},"end":{"row":152,"column":76},"action":"insert","lines":[" "],"id":2907}],[{"start":{"row":157,"column":48},"end":{"row":157,"column":52},"action":"remove","lines":["    "],"id":2908},{"start":{"row":157,"column":44},"end":{"row":157,"column":48},"action":"remove","lines":["    "]},{"start":{"row":157,"column":40},"end":{"row":157,"column":44},"action":"remove","lines":["    "]},{"start":{"row":157,"column":36},"end":{"row":157,"column":40},"action":"remove","lines":["    "]},{"start":{"row":157,"column":32},"end":{"row":157,"column":36},"action":"remove","lines":["    "]},{"start":{"row":157,"column":28},"end":{"row":157,"column":32},"action":"remove","lines":["    "]},{"start":{"row":157,"column":24},"end":{"row":157,"column":28},"action":"remove","lines":["    "]},{"start":{"row":157,"column":20},"end":{"row":157,"column":24},"action":"remove","lines":["    "]},{"start":{"row":157,"column":16},"end":{"row":157,"column":20},"action":"remove","lines":["    "]},{"start":{"row":157,"column":12},"end":{"row":157,"column":16},"action":"remove","lines":["    "]},{"start":{"row":157,"column":8},"end":{"row":157,"column":12},"action":"remove","lines":["    "]},{"start":{"row":157,"column":4},"end":{"row":157,"column":8},"action":"remove","lines":["    "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":156,"column":77},"end":{"row":157,"column":0},"action":"remove","lines":["",""],"id":2909}],[{"start":{"row":156,"column":77},"end":{"row":156,"column":78},"action":"insert","lines":[" "],"id":2910}],[{"start":{"row":161,"column":17},"end":{"row":161,"column":18},"action":"insert","lines":[" "],"id":2911}],[{"start":{"row":161,"column":19},"end":{"row":161,"column":20},"action":"insert","lines":[" "],"id":2912}],[{"start":{"row":211,"column":30},"end":{"row":212,"column":0},"action":"insert","lines":["",""],"id":2913},{"start":{"row":212,"column":0},"end":{"row":212,"column":30},"action":"insert","lines":["                              "]}],[{"start":{"row":193,"column":0},"end":{"row":194,"column":0},"action":"remove","lines":["",""],"id":2914},{"start":{"row":192,"column":60},"end":{"row":193,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":147,"column":7},"end":{"row":193,"column":8},"action":"remove","lines":[" elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)","        "],"id":2929}],[{"start":{"row":142,"column":4},"end":{"row":142,"column":8},"action":"remove","lines":["    "],"id":2930}],[{"start":{"row":143,"column":6},"end":{"row":143,"column":7},"action":"remove","lines":[" "],"id":2931}],[{"start":{"row":143,"column":6},"end":{"row":143,"column":7},"action":"remove","lines":[" "],"id":2932},{"start":{"row":143,"column":5},"end":{"row":143,"column":6},"action":"remove","lines":[" "]},{"start":{"row":143,"column":4},"end":{"row":143,"column":5},"action":"remove","lines":[" "]}],[{"start":{"row":144,"column":8},"end":{"row":144,"column":12},"action":"remove","lines":["    "],"id":2933}],[{"start":{"row":145,"column":8},"end":{"row":145,"column":12},"action":"remove","lines":["    "],"id":2934}],[{"start":{"row":149,"column":4},"end":{"row":149,"column":8},"action":"remove","lines":["    "],"id":2935}],[{"start":{"row":151,"column":6},"end":{"row":151,"column":7},"action":"remove","lines":[" "],"id":2936}],[{"start":{"row":151,"column":6},"end":{"row":151,"column":7},"action":"remove","lines":[" "],"id":2937},{"start":{"row":151,"column":5},"end":{"row":151,"column":6},"action":"remove","lines":[" "]},{"start":{"row":151,"column":4},"end":{"row":151,"column":5},"action":"remove","lines":[" "]}],[{"start":{"row":152,"column":4},"end":{"row":152,"column":8},"action":"remove","lines":["    "],"id":2938}],[{"start":{"row":153,"column":4},"end":{"row":153,"column":8},"action":"remove","lines":["    "],"id":2939}],[{"start":{"row":157,"column":4},"end":{"row":157,"column":8},"action":"remove","lines":["    "],"id":2940}],[{"start":{"row":142,"column":0},"end":{"row":142,"column":4},"action":"insert","lines":["    "],"id":2941},{"start":{"row":143,"column":0},"end":{"row":143,"column":4},"action":"insert","lines":["    "]},{"start":{"row":144,"column":0},"end":{"row":144,"column":4},"action":"insert","lines":["    "]},{"start":{"row":145,"column":0},"end":{"row":145,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":149,"column":0},"end":{"row":149,"column":4},"action":"insert","lines":["    "],"id":2942},{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"insert","lines":["    "]},{"start":{"row":151,"column":0},"end":{"row":151,"column":4},"action":"insert","lines":["    "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":4},"action":"insert","lines":["    "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"insert","lines":["    "]},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":156,"column":0},"end":{"row":156,"column":4},"action":"insert","lines":["    "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":4},"action":"insert","lines":["    "]},{"start":{"row":158,"column":0},"end":{"row":158,"column":4},"action":"insert","lines":["    "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":4},"action":"insert","lines":["    "]},{"start":{"row":160,"column":0},"end":{"row":160,"column":4},"action":"insert","lines":["    "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":4},"action":"insert","lines":["    "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":164,"column":4},"end":{"row":179,"column":0},"action":"insert","lines":["page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  ","                              ",""],"id":2943}],[{"start":{"row":166,"column":4},"end":{"row":166,"column":8},"action":"remove","lines":["    "],"id":2944}],[{"start":{"row":167,"column":4},"end":{"row":167,"column":8},"action":"remove","lines":["    "],"id":2945}],[{"start":{"row":168,"column":4},"end":{"row":168,"column":8},"action":"remove","lines":["    "],"id":2946}],[{"start":{"row":172,"column":4},"end":{"row":172,"column":8},"action":"remove","lines":["    "],"id":2947}],[{"start":{"row":149,"column":0},"end":{"row":149,"column":4},"action":"insert","lines":["    "],"id":2948},{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"insert","lines":["    "]},{"start":{"row":151,"column":0},"end":{"row":151,"column":4},"action":"insert","lines":["    "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":4},"action":"insert","lines":["    "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"insert","lines":["    "]},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":156,"column":0},"end":{"row":156,"column":4},"action":"insert","lines":["    "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":4},"action":"insert","lines":["    "]},{"start":{"row":158,"column":0},"end":{"row":158,"column":4},"action":"insert","lines":["    "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":4},"action":"insert","lines":["    "]},{"start":{"row":160,"column":0},"end":{"row":160,"column":4},"action":"insert","lines":["    "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":4},"action":"insert","lines":["    "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":164,"column":0},"end":{"row":164,"column":4},"action":"insert","lines":["    "],"id":2949},{"start":{"row":165,"column":0},"end":{"row":165,"column":4},"action":"insert","lines":["    "]},{"start":{"row":166,"column":0},"end":{"row":166,"column":4},"action":"insert","lines":["    "]},{"start":{"row":167,"column":0},"end":{"row":167,"column":4},"action":"insert","lines":["    "]},{"start":{"row":168,"column":0},"end":{"row":168,"column":4},"action":"insert","lines":["    "]},{"start":{"row":169,"column":0},"end":{"row":169,"column":4},"action":"insert","lines":["    "]},{"start":{"row":170,"column":0},"end":{"row":170,"column":4},"action":"insert","lines":["    "]},{"start":{"row":171,"column":0},"end":{"row":171,"column":4},"action":"insert","lines":["    "]},{"start":{"row":172,"column":0},"end":{"row":172,"column":4},"action":"insert","lines":["    "]},{"start":{"row":173,"column":0},"end":{"row":173,"column":4},"action":"insert","lines":["    "]},{"start":{"row":174,"column":0},"end":{"row":174,"column":4},"action":"insert","lines":["    "]},{"start":{"row":175,"column":0},"end":{"row":175,"column":4},"action":"insert","lines":["    "]},{"start":{"row":176,"column":0},"end":{"row":176,"column":4},"action":"insert","lines":["    "]},{"start":{"row":177,"column":0},"end":{"row":177,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":166,"column":7},"end":{"row":166,"column":53},"action":"remove","lines":[" total_filter_recipes = filter_recipes.count()"],"id":2950},{"start":{"row":166,"column":6},"end":{"row":166,"column":7},"action":"remove","lines":[" "]},{"start":{"row":166,"column":5},"end":{"row":166,"column":6},"action":"remove","lines":[" "]},{"start":{"row":166,"column":4},"end":{"row":166,"column":5},"action":"remove","lines":[" "]},{"start":{"row":166,"column":0},"end":{"row":166,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":165,"column":83},"end":{"row":166,"column":0},"action":"remove","lines":["",""],"id":2951}],[{"start":{"row":166,"column":4},"end":{"row":166,"column":94},"action":"remove","lines":["    recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)"],"id":2952},{"start":{"row":166,"column":0},"end":{"row":166,"column":4},"action":"remove","lines":["    "]},{"start":{"row":165,"column":83},"end":{"row":166,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":171,"column":35},"end":{"row":171,"column":61},"action":"remove","lines":[" recipe = recipes_fetched,"],"id":2953},{"start":{"row":171,"column":34},"end":{"row":171,"column":35},"action":"remove","lines":[" "]},{"start":{"row":171,"column":33},"end":{"row":171,"column":34},"action":"remove","lines":[" "]},{"start":{"row":171,"column":32},"end":{"row":171,"column":33},"action":"remove","lines":[" "]},{"start":{"row":171,"column":28},"end":{"row":171,"column":32},"action":"remove","lines":["    "]},{"start":{"row":171,"column":24},"end":{"row":171,"column":28},"action":"remove","lines":["    "]},{"start":{"row":171,"column":20},"end":{"row":171,"column":24},"action":"remove","lines":["    "]},{"start":{"row":171,"column":16},"end":{"row":171,"column":20},"action":"remove","lines":["    "]},{"start":{"row":171,"column":12},"end":{"row":171,"column":16},"action":"remove","lines":["    "]}],[{"start":{"row":171,"column":8},"end":{"row":171,"column":12},"action":"remove","lines":["    "],"id":2954},{"start":{"row":171,"column":4},"end":{"row":171,"column":8},"action":"remove","lines":["    "]},{"start":{"row":171,"column":0},"end":{"row":171,"column":4},"action":"remove","lines":["    "]},{"start":{"row":170,"column":45},"end":{"row":171,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":164,"column":0},"end":{"row":174,"column":62},"action":"remove","lines":["        page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","        pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","        return render_template('search.html',","                                    page = page,","                                    query = query,","                                    per_page = per_page,","                                    pagination = pagination)  "],"id":2955}],[{"start":{"row":157,"column":8},"end":{"row":157,"column":12},"action":"remove","lines":["    "],"id":2956},{"start":{"row":157,"column":4},"end":{"row":157,"column":8},"action":"remove","lines":["    "]}],[{"start":{"row":157,"column":4},"end":{"row":157,"column":5},"action":"insert","lines":[" "],"id":2957},{"start":{"row":157,"column":5},"end":{"row":157,"column":6},"action":"insert","lines":[" "]},{"start":{"row":157,"column":6},"end":{"row":157,"column":7},"action":"insert","lines":[" "]},{"start":{"row":157,"column":7},"end":{"row":157,"column":8},"action":"insert","lines":[" "]}],[{"start":{"row":157,"column":8},"end":{"row":157,"column":12},"action":"insert","lines":["    "],"id":2958}],[{"start":{"row":165,"column":8},"end":{"row":165,"column":45},"action":"insert","lines":["return render_template('search.html',"],"id":2959}],[{"start":{"row":165,"column":44},"end":{"row":165,"column":45},"action":"remove","lines":[","],"id":2960}],[{"start":{"row":165,"column":44},"end":{"row":165,"column":45},"action":"insert","lines":[")"],"id":2961}],[{"start":{"row":165,"column":44},"end":{"row":165,"column":45},"action":"insert","lines":[","],"id":2962}],[{"start":{"row":165,"column":45},"end":{"row":166,"column":0},"action":"insert","lines":["",""],"id":2963},{"start":{"row":166,"column":0},"end":{"row":166,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":166,"column":8},"end":{"row":169,"column":63},"action":"insert","lines":["page = page,","                                        query = query,","                                        per_page = per_page,","                                        pagination = pagination"],"id":2964}],[{"start":{"row":166,"column":8},"end":{"row":166,"column":12},"action":"insert","lines":["    "],"id":2965}],[{"start":{"row":166,"column":12},"end":{"row":166,"column":16},"action":"insert","lines":["    "],"id":2966}],[{"start":{"row":166,"column":16},"end":{"row":166,"column":20},"action":"insert","lines":["    "],"id":2967}],[{"start":{"row":166,"column":20},"end":{"row":166,"column":24},"action":"insert","lines":["    "],"id":2968}],[{"start":{"row":166,"column":24},"end":{"row":166,"column":28},"action":"insert","lines":["    "],"id":2969}],[{"start":{"row":166,"column":28},"end":{"row":166,"column":32},"action":"insert","lines":["    "],"id":2970}],[{"start":{"row":166,"column":32},"end":{"row":166,"column":36},"action":"insert","lines":["    "],"id":2971}],[{"start":{"row":166,"column":36},"end":{"row":166,"column":40},"action":"insert","lines":["    "],"id":2972}],[{"start":{"row":167,"column":40},"end":{"row":167,"column":54},"action":"remove","lines":["query = query,"],"id":2973},{"start":{"row":167,"column":36},"end":{"row":167,"column":40},"action":"remove","lines":["    "]},{"start":{"row":167,"column":32},"end":{"row":167,"column":36},"action":"remove","lines":["    "]},{"start":{"row":167,"column":28},"end":{"row":167,"column":32},"action":"remove","lines":["    "]},{"start":{"row":167,"column":24},"end":{"row":167,"column":28},"action":"remove","lines":["    "]},{"start":{"row":167,"column":20},"end":{"row":167,"column":24},"action":"remove","lines":["    "]},{"start":{"row":167,"column":16},"end":{"row":167,"column":20},"action":"remove","lines":["    "]},{"start":{"row":167,"column":12},"end":{"row":167,"column":16},"action":"remove","lines":["    "]},{"start":{"row":167,"column":8},"end":{"row":167,"column":12},"action":"remove","lines":["    "]},{"start":{"row":167,"column":4},"end":{"row":167,"column":8},"action":"remove","lines":["    "]},{"start":{"row":167,"column":0},"end":{"row":167,"column":4},"action":"remove","lines":["    "]},{"start":{"row":166,"column":52},"end":{"row":167,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":166,"column":0},"end":{"row":168,"column":63},"action":"remove","lines":["                                        page = page,","                                        per_page = per_page,","                                        pagination = pagination"],"id":2974},{"start":{"row":165,"column":45},"end":{"row":166,"column":0},"action":"remove","lines":["",""]},{"start":{"row":165,"column":44},"end":{"row":165,"column":45},"action":"remove","lines":[","]}],[{"start":{"row":132,"column":0},"end":{"row":165,"column":53},"action":"remove","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","        query = {}","        if cuisine and allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen, \"meal_type\":meal})","            query = {cuisine,allergen,meal}","        ","       ","    ","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                       per_page_parameter = 'per_page')","            total_filter_recipes = filter_recipes.count()","            recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","            pagination = Pagination(page = page,","                                        per_page = ITEMS_PER_PAGE,","                                        total = total_filter_recipes,","                                        record_name = 'Recipes')","            return render_template('search.html',","                                        recipe = recipes_fetched,","                                        page = page,","                                        query = query,","                                        per_page = per_page,","                                        pagination = pagination)  ","                              ","","        return render_template('search.html')        "],"id":2975},{"start":{"row":132,"column":0},"end":{"row":210,"column":0},"action":"insert","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","        query = {}","        if cuisine and allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen, \"meal_type\":meal})","            query = {cuisine,allergen,meal}","        ","        elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)","        ","    ","        page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  ","                              ",""]}],[{"start":{"row":202,"column":56},"end":{"row":203,"column":0},"action":"insert","lines":["",""],"id":2976},{"start":{"row":203,"column":0},"end":{"row":203,"column":32},"action":"insert","lines":["                                "]}],[{"start":{"row":203,"column":28},"end":{"row":203,"column":32},"action":"remove","lines":["    "],"id":2977},{"start":{"row":203,"column":24},"end":{"row":203,"column":28},"action":"remove","lines":["    "]},{"start":{"row":203,"column":20},"end":{"row":203,"column":24},"action":"remove","lines":["    "]},{"start":{"row":203,"column":16},"end":{"row":203,"column":20},"action":"remove","lines":["    "]},{"start":{"row":203,"column":12},"end":{"row":203,"column":16},"action":"remove","lines":["    "]},{"start":{"row":203,"column":8},"end":{"row":203,"column":12},"action":"remove","lines":["    "]}],[{"start":{"row":203,"column":8},"end":{"row":203,"column":48},"action":"insert","lines":[" recipes = [recipe for recipe in cursor]"],"id":2978}],[{"start":{"row":203,"column":2},"end":{"row":203,"column":48},"action":"remove","lines":["       recipes = [recipe for recipe in cursor]"],"id":2979}],[{"start":{"row":147,"column":7},"end":{"row":193,"column":8},"action":"remove","lines":[" elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)","        "],"id":2986}],[{"start":{"row":149,"column":0},"end":{"row":149,"column":4},"action":"insert","lines":["    "],"id":2987},{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"insert","lines":["    "]},{"start":{"row":151,"column":0},"end":{"row":151,"column":4},"action":"insert","lines":["    "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":4},"action":"insert","lines":["    "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"insert","lines":["    "]},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":156,"column":0},"end":{"row":156,"column":4},"action":"insert","lines":["    "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":4},"action":"insert","lines":["    "]},{"start":{"row":158,"column":0},"end":{"row":158,"column":4},"action":"insert","lines":["    "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":4},"action":"insert","lines":["    "]},{"start":{"row":160,"column":0},"end":{"row":160,"column":4},"action":"insert","lines":["    "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":4},"action":"insert","lines":["    "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":4},"action":"insert","lines":["    "]},{"start":{"row":163,"column":0},"end":{"row":163,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":165,"column":8},"end":{"row":171,"column":30},"action":"insert","lines":["return render_template('search.html',","                                    recipe = recipes_fetched,","                                    page = page,","                                    query = query,","                                    per_page = per_page,","                                    pagination = pagination)  ","                              "],"id":2988}],[{"start":{"row":166,"column":36},"end":{"row":169,"column":55},"action":"remove","lines":["recipe = recipes_fetched,","                                    page = page,","                                    query = query,","                                    per_page = per_page"],"id":2989}],[{"start":{"row":166,"column":36},"end":{"row":166,"column":37},"action":"remove","lines":[","],"id":2990}],[{"start":{"row":165,"column":8},"end":{"row":167,"column":61},"action":"remove","lines":["return render_template('search.html',","                                    ","                                    pagination = pagination) "],"id":2991},{"start":{"row":165,"column":8},"end":{"row":180,"column":0},"action":"insert","lines":["page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","  ","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  ",""]}],[{"start":{"row":143,"column":2},"end":{"row":145,"column":43},"action":"remove","lines":["      if cuisine and allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen, \"meal_type\":meal})","            query = {cuisine,allergen,meal}"],"id":2992}],[{"start":{"row":143,"column":2},"end":{"row":143,"column":4},"action":"insert","lines":["  "],"id":2993}],[{"start":{"row":143,"column":4},"end":{"row":143,"column":8},"action":"insert","lines":["    "],"id":2994}],[{"start":{"row":143,"column":8},"end":{"row":143,"column":12},"action":"insert","lines":["    "],"id":2995}],[{"start":{"row":143,"column":8},"end":{"row":143,"column":12},"action":"remove","lines":["    "],"id":2996}],[{"start":{"row":143,"column":8},"end":{"row":147,"column":0},"action":"insert","lines":["elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","",""],"id":2997}],[{"start":{"row":143,"column":9},"end":{"row":143,"column":10},"action":"remove","lines":["l"],"id":2998},{"start":{"row":143,"column":8},"end":{"row":143,"column":9},"action":"remove","lines":["e"]}],[{"start":{"row":146,"column":0},"end":{"row":147,"column":0},"action":"remove","lines":["",""],"id":2999}],[{"start":{"row":146,"column":0},"end":{"row":147,"column":8},"action":"remove","lines":["","        "],"id":3000},{"start":{"row":146,"column":0},"end":{"row":147,"column":7},"action":"remove","lines":["","       "]},{"start":{"row":146,"column":0},"end":{"row":147,"column":4},"action":"remove","lines":["","    "]},{"start":{"row":146,"column":0},"end":{"row":147,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":162,"column":8},"end":{"row":176,"column":58},"action":"remove","lines":["page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","  ","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  "],"id":3002}],[{"start":{"row":143,"column":8},"end":{"row":162,"column":8},"action":"remove","lines":["if cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","            total_filter_recipes = filter_recipes.count()","            recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","      ","            return render_template('search.html',","                                    recipe = recipes_fetched,","                                    page = page,","                                    query = query,","                                    per_page = per_page,","                                    pagination = pagination)  ","                              ","        "],"id":3004},{"start":{"row":143,"column":8},"end":{"row":170,"column":77},"action":"insert","lines":[" ","        query = {}","        if cuisine:","            filter_cuisine_recipes = mongo.db.recipes.find({\"cuisine_name\": cuisine})","            total_filter_recipes=filter_cuisine_recipes.count()","            cuisine_recipes_fetched =filter_cuisine_recipes.skip((page - 1)*per_page).limit(per_page)","            pages = range(1, int(math.ceil(total_filter_recipes / per_page)) + 1)","            return render_template('search.html', recipes=cuisine_recipes_fetched, query=cuisine, page=page, pages=pages, total=total_filter_recipes)","        ","        if allergen:","            filter_allergen_recipes = mongo.db.recipes.find({\"allergen_name\": allergen})","            total_filter_recipes= filter_allergen_recipes.count()","            allergen_recipes_fetched = filter_allergen_recipes.skip((page - 1)*per_page).limit(per_page)","            pages = range(1, int(math.ceil(total_filter_recipes / per_page)) + 1)","            return render_template('search.html', recipes=allergen_recipes_fetched, query=allergen,page=page, pages=pages, total=total_filter_recipes)","            ","        else:","            #  create the index","            mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            ","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', recipes=recipes, query=search_item)","        ","    return render_template('search.html', recipes=recipes, query=search_item)"]}],[{"start":{"row":142,"column":0},"end":{"row":142,"column":18},"action":"remove","lines":["        query = {}"],"id":3005},{"start":{"row":141,"column":8},"end":{"row":142,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":151,"column":6},"end":{"row":157,"column":3},"action":"remove","lines":["  if allergen:","            filter_allergen_recipes = mongo.db.recipes.find({\"allergen_name\": allergen})","            total_filter_recipes= filter_allergen_recipes.count()","            allergen_recipes_fetched = filter_allergen_recipes.skip((page - 1)*per_page).limit(per_page)","            pages = range(1, int(math.ceil(total_filter_recipes / per_page)) + 1)","            return render_template('search.html', recipes=allergen_recipes_fetched, query=allergen,page=page, pages=pages, total=total_filter_recipes)","   "],"id":3006}],[{"start":{"row":147,"column":9},"end":{"row":148,"column":81},"action":"remove","lines":["   cuisine_recipes_fetched =filter_cuisine_recipes.skip((page - 1)*per_page).limit(per_page)","            pages = range(1, int(math.ceil(total_filter_recipes / per_page)) + 1)"],"id":3007}],[{"start":{"row":148,"column":98},"end":{"row":148,"column":148},"action":"remove","lines":["page=page, pages=pages, total=total_filter_recipes"],"id":3008},{"start":{"row":148,"column":97},"end":{"row":148,"column":98},"action":"remove","lines":[" "]},{"start":{"row":148,"column":96},"end":{"row":148,"column":97},"action":"remove","lines":[","]}],[{"start":{"row":148,"column":58},"end":{"row":148,"column":81},"action":"remove","lines":["cuisine_recipes_fetched"],"id":3009},{"start":{"row":148,"column":58},"end":{"row":148,"column":80},"action":"insert","lines":["filter_cuisine_recipes"]}],[{"start":{"row":132,"column":0},"end":{"row":163,"column":1},"action":"remove","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","         ","        query = {}","        if cuisine:","            filter_cuisine_recipes = mongo.db.recipes.find({\"cuisine_name\": cuisine})","            total_filter_recipes=filter_cuisine_recipes.count()","         ","            return render_template('search.html', recipes=filter_cuisine_recipes, query=cuisine)","        ","               ","        else:","            #  create the index","            mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            ","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', recipes=recipes, query=search_item)","        ","    return render_template('search.html', recipes=recipes, query=search_item)"," "],"id":3010},{"start":{"row":132,"column":0},"end":{"row":211,"column":0},"action":"insert","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","        query = {}","        if cuisine and allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen, \"meal_type\":meal})","            query = {cuisine,allergen,meal}","        ","        elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)","        ","    ","        page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","  ","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  ","                              ",""]}],[{"start":{"row":146,"column":2},"end":{"row":192,"column":60},"action":"remove","lines":["      ","        elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)"],"id":3011}],[{"start":{"row":143,"column":18},"end":{"row":143,"column":39},"action":"remove","lines":[" and allergen and mea"],"id":3012}],[{"start":{"row":143,"column":17},"end":{"row":143,"column":18},"action":"remove","lines":["e"],"id":3013}],[{"start":{"row":143,"column":17},"end":{"row":143,"column":18},"action":"insert","lines":["e"],"id":3014}],[{"start":{"row":143,"column":18},"end":{"row":143,"column":19},"action":"remove","lines":["l"],"id":3015}],[{"start":{"row":144,"column":76},"end":{"row":144,"column":118},"action":"remove","lines":["\"allergen_name\":allergen, \"meal_type\":meal"],"id":3016},{"start":{"row":144,"column":75},"end":{"row":144,"column":76},"action":"remove","lines":[" "]},{"start":{"row":144,"column":74},"end":{"row":144,"column":75},"action":"remove","lines":[","]}],[{"start":{"row":145,"column":28},"end":{"row":145,"column":42},"action":"remove","lines":[",allergen,meal"],"id":3017}],[{"start":{"row":148,"column":0},"end":{"row":148,"column":4},"action":"insert","lines":["    "],"id":3018},{"start":{"row":149,"column":0},"end":{"row":149,"column":4},"action":"insert","lines":["    "]},{"start":{"row":150,"column":0},"end":{"row":150,"column":4},"action":"insert","lines":["    "]},{"start":{"row":151,"column":0},"end":{"row":151,"column":4},"action":"insert","lines":["    "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":4},"action":"insert","lines":["    "]},{"start":{"row":153,"column":0},"end":{"row":153,"column":4},"action":"insert","lines":["    "]},{"start":{"row":154,"column":0},"end":{"row":154,"column":4},"action":"insert","lines":["    "]},{"start":{"row":155,"column":0},"end":{"row":155,"column":4},"action":"insert","lines":["    "]},{"start":{"row":156,"column":0},"end":{"row":156,"column":4},"action":"insert","lines":["    "]},{"start":{"row":157,"column":0},"end":{"row":157,"column":4},"action":"insert","lines":["    "]},{"start":{"row":158,"column":0},"end":{"row":158,"column":4},"action":"insert","lines":["    "]},{"start":{"row":159,"column":0},"end":{"row":159,"column":4},"action":"insert","lines":["    "]},{"start":{"row":160,"column":0},"end":{"row":160,"column":4},"action":"insert","lines":["    "]},{"start":{"row":161,"column":0},"end":{"row":161,"column":4},"action":"insert","lines":["    "]},{"start":{"row":162,"column":0},"end":{"row":162,"column":4},"action":"insert","lines":["    "]},{"start":{"row":163,"column":0},"end":{"row":163,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":132,"column":0},"end":{"row":163,"column":62},"action":"remove","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","        query = {}","        if cuisine:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","  ","        ","        ","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","            total_filter_recipes = filter_recipes.count()","            recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","      ","            return render_template('search.html',","                                    recipe = recipes_fetched,","                                    page = page,","                                    query = query,","                                    per_page = per_page,","                                    pagination = pagination)  "],"id":3019},{"start":{"row":132,"column":0},"end":{"row":211,"column":0},"action":"insert","lines":["@app.route('/search_recipes',methods=['GET','POST'])","def search_recipes():","    \"\"\" Advanced search for recipes based on different criterias \"\"\"","    if request.method == 'POST':","        cuisine = request.form.get(\"cuisine_name_filter\")","        allergen = request.form.get(\"allergen_name_filter\")","        meal = request.form.get(\"meal_type_filter\")","        search_item = request.form.get('search_item')","        ","        ","        query = {}","        if cuisine and allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen, \"meal_type\":meal})","            query = {cuisine,allergen,meal}","        ","        elif cuisine and allergen:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"allergen_name\":allergen})","            query = {cuisine,allergen}","","        elif cuisine and meal:","            filter_recipes = mongo.db.recipes.find({\"cuisine_name\":cuisine, \"meal_type\":meal})","            query = {cuisine,meal}","","        elif allergen and meal:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen, \"meal_type\":meal})","            query = {allergen,meal}","","        elif cuisine:","            filter_recipes=mongo.db.recipes.find({\"cuisine_name\":cuisine})","            query = {cuisine}","","        elif allergen:","            filter_recipes = mongo.db.recipes.find({\"allergen_name\":allergen})","            query = {allergen}","","        elif meal:","            filter_recipes = mongo.db.recipes.find({\"meal_type\":meal})","            query = {meal}","   ","        else:","            #  create the index","            filter_recipes = mongo.db.recipes.create_index( [(\"$**\", 'text')] )","            page, per_page, offset = get_page_args(page_parameter = 'page',","                                                   per_page_parameter = 'per_page')","","             # search with the search term that came through the form","            cursor = mongo.db.recipes.find({ \"$text\": { \"$search\": search_item } })","            total_filter_recipes = cursor.count()","            pagination = Pagination(page = page,","                                    per_page = ITEMS_PER_PAGE,","                                    total = total_filter_recipes,","                                    record_name = 'Recipes')","            recipes = [recipe for recipe in cursor]","            ","            # send recipes to page","            return render_template('search.html', ","                                    recipes = recipes, ","                                    query = search_item,","                                    page = page,","                                    per_page = per_page,","                                    pagination = pagination)","        ","    ","        page, per_page, offset = get_page_args(page_parameter = 'page',","                                               per_page_parameter = 'per_page')","        total_filter_recipes = filter_recipes.count()","        recipes_fetched = filter_recipes.skip((page - 1)*ITEMS_PER_PAGE).limit(ITEMS_PER_PAGE)","        pagination = Pagination(page = page,","                                per_page = ITEMS_PER_PAGE,","                                total = total_filter_recipes,","                                record_name = 'Recipes')","  ","        return render_template('search.html',","                                recipe = recipes_fetched,","                                page = page,","                                query = query,","                                per_page = per_page,","                                pagination = pagination)  ","                              ",""]}],[{"start":{"row":205,"column":38},"end":{"row":205,"column":39},"action":"insert","lines":["s"],"id":3020}]]},"ace":{"folds":[],"scrolltop":2616.8125,"scrollleft":0,"selection":{"start":{"row":205,"column":58},"end":{"row":205,"column":58},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":70,"state":"start","mode":"ace/mode/python"}},"timestamp":1566480874155,"hash":"b0194bb5b96a7dce4096377fca809af252408566"}